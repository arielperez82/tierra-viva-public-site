---
import type { CollectionEntry } from "astro:content";
import { getCollection, render } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import { SITE_TITLE } from "../../consts";
import Link from "../../components/Link.astro";

export async function getStaticPaths() {
  const entries = await getCollection("research");
  return entries.map((entry) => ({
    params: { slug: entry.id },
    props: { entry },
  }));
}

type Props = { entry: CollectionEntry<"research"> };
const { entry } = Astro.props;
const { Content } = await render(entry);
---

<BaseLayout
  title={`${entry.data.title} | ${SITE_TITLE}`}
  description={entry.data.description}
>
  <article class="mx-auto max-w-3xl px-4 py-16 sm:px-6 sm:py-24">
    <header>
      <h1 class="text-2xl tracking-tight sm:text-3xl">
        {entry.data.title}
      </h1>
      <p class="mt-2 text-sm text-tierra-forest-dark/70">
        <time datetime={entry.data.pubDate.toISOString()}>
          {entry.data.pubDate.toLocaleDateString("en-US", {
            year: "numeric",
            month: "long",
            day: "numeric",
          })}
        </time>
      </p>
    </header>
    <div class="research-body mt-8 space-y-4 text-base leading-relaxed text-tierra-graphite/90 [&_h2]:mt-8 [&_h2]:text-xl [&_h2]:font-semibold [&_p]:mt-2">
      <Content />
    </div>
    <p class="mt-10">
      <Link
        href="/research"
        class="font-medium text-tierra-forest underline decoration-tierra-stone underline-offset-4 hover:decoration-tierra-forest focus:outline-none focus:ring-2 focus:ring-tierra-lime focus:ring-offset-2"
      >
        Back to Research &amp; Insights
      </Link>
    </p>
  </article>
</BaseLayout>
